import re

valid_chars = set(
    "\n !\"#$%&'()*+,-./0123456789:;<=>?@ABCDEFGHIJKLMNOPQRSTUVWXYZ[\\]^_"
    "abcdefghijklmnopqrstuvwxyz{|}~Â¢Â£Â¥Â§Â©Â«Â®Â°Â±Â»Ã•ÃµÇ¦Ç§Öâ‚¬â‚´â‚¼â‚½â„–â„¢âˆšâ‰ˆâ‰¤â‰¥"
)

replace_chars = {
    "ğ—”ĞÎ‘Ä„Ã€ÃÃ„Ã…Ä€Ä‚Ã‚Ãƒ": "A",
    "ğ—•Ğ‘": "B",
    "ğ—–Ğ¡Ã‡ÄŒÄ†ÄˆÄŠ": "C",
    "ğ——ğ˜¿ÄÃÄĞ”": "D",
    "ğ—˜Î•Ğ•Ä˜ÃˆÃ‰ÄšÃŠĞ­": "E",
    "ğ—™ÏœĞ¤": "F",
    "ğ—šğ†ÄÇ´á¸ ÄœĞ“Ò": "G",
    "ğ—›": "H",
    "ğˆÃŒÃÃÃÄªÄ°î€“î€”î€•Ğ†â… ğ—œĞ˜": "I",
    "ÉˆÄ´": "J",
    "ĞŒÒœĞš": "K",
    "ğ—ŸÅĞ›": "L",
    "ğ— ğ™ˆĞœĞ¼á´¹â“‚": "M",
    "ğ—¡ğ™‰ğÅƒÃ‘Å‡ÎĞÒ¢Ó‰": "N",
    "ğ—¢Ã’Ã“Ã–ÅŒÅÅÃ”Ç‘ĞÃ˜Î¸Ó¨": "O",
    "ğ—£ĞŸ": "P",
    "ğ—¤Òš": "Q",
    "ğ—¥Å˜Ğ ": "R",
    "ğ’á¹¢È˜ÅÅšÅ Åœá¹ ": "S",
    "ğ—§ğ“áµ€ÈšÅ¤Ğ¢â“‰â‚¸": "T",
    "ğ—¨ğ”ÃšÃœÅ®Å°ÅªĞ£": "U",
    "Ğ’": "V",
    # "": "W",
    "â…©": "X",
    "ÃÒ°Ò®Ğ™Ğ«": "Y",
    "ğ—­Å½Å¹Å»ÆµĞ—": "Z",
    "Ã†": "AE",
    "Ã‹Ğ": "Yo",
    "Ğ–Ò–": "Zh",
    "Ğ¥Ò²": "Kh",
    "Ğ¦": "Ts",
    "Ğ§Ò¶Ò¸": "Ch",
    "Ğ¨": "Sh",
    "Ğ©": "Shch",
    "Ğ®": "Yu",
    "Ğ¯": "Ya",
    "Ò’": "G'",
    "Ó®Ğ": "O'",

    "ğ—®Ã Ã¡Ã¢Ã£Ã¤Ã¥ÄÄƒÄ…ğ™–Î±áº§á¼€áµ…É‘Ğ°": "a",
    "ğ—¯ğ™—áºÎ²ÃŸĞ±": "b",
    "ğ—°ğ™˜Ã§Ä‡ÄÄ‰Ä‹": "c",
    "ğ™™Ã°ÄÄ‘Ğ´": "d",
    "ğ—²ğ™šÃ¨Ã©ÃªÄ“Ä—Ä™Ä›ĞµÓ™ÑÑ": "e",
    "ğ—³Ñ„": "f",
    "ğ—´ÄŸÇµá¸¡ÄĞ³Ò‘Ñ“": "g",
    "ğ—µÒ»Òº": "h",
    "ğ—¶ğ™Â¡Ã­Ã¯Ğ¸Ñ–Ã®Î¯Ã¬Ä«": "i",
    "É‰Äµ": "j",
    "ğ—¸ĞºÎºÑœÒ": "k",
    "ğ—¹ğ™¡Ä±Å‚Ğ»Ë¡": "l",
    "ğ—ºğ™¢ï½": "m",
    "ğ—»ğ™£Ã±Å„Å†Å‹ÅˆÎ®Î·È Ğ½Ò£ÓŠ": "n",
    "ğ™¤Ã²Ã³Ã´Ã¶Ã¸Å‘Ğ¾Ó©ÅÅÎ¿ÏƒÉ’Ç’": "o",
    "ğ—½ğ™¥Ğ¿": "p",
    "Ò›": "q",
    "ğ—¿ğ™§Ñ€Å™": "r",
    "ğ˜€ğ™¨Å›ÅŸÅ¡È™ÑÅá¹¡á¹£": "s",
    "ğ˜ğ™©È›Ñ‚Å¥": "t",
    "ğ˜‚ğ™ªÃ¹ÃºÃ¼Ï…Å«Å³Ã»ÂµÑƒÂµ": "u",
    "Î½Ğ²": "v",
    "ğ˜„Ï": "w",
    "Ã—âš”Ó½": "x",
    "ğ˜†Ã½Ã¿Ò¯Ò±Î³Ğ¹Ñ‹Ó£Öº": "y",
    "ğ˜‡Å¾Ğ·Æ¶Å¼": "z",
    "Ã¦": "ae",
    "Ã«Ñ‘": "yo",
    "Ğ¶Ò—": "zh",
    "Ñ…Ò³": "kh",
    "Ñ†": "ts",
    "Ñ‡Ò¹Ò·": "ch",
    "Ñˆ": "sh",
    "Ñ‰": "shch",
    "Ñ": "yu",
    "Ñ": "ya",
    "Ò“": "g'",
    "Ó¯á»¹Ñ": "o'",
    "ï¬": "fi",
    "ï¬‚": "fl",

    "â°â‚€ğŸ¬ï¼": "0",
    "Â¹â‚ğŸ­â‘ ": "1",
    "Â²â‚‚â‘¡": "2",
    "Â³â‚ƒá¶Ÿâ‘¢": "3",
    "â´â‚„ï¼”": "4",
    "âµâ‚…ï¼•": "5",
    "â¶â‚†": "6",
    "â·â‚‡": "7",
    "â¸â‚ˆ": "8",
    "â¹â‚‰": "9",
    "ï¼ˆï´¾": "(",
    "ï¼‰ï´¿": ")",
    "â€‘â€“â€”âˆ’ï¼â€Œâ€•â”€âƒâ€â€‘â€“â€”â€’Ë—": "-",
    "â€º": ">",
    "ï¼": "=",
    "â“": "?",
    "â—ï¼": "!",
    "â‰": "?!",
    "â€¼": "!!",
    "ï¼›": ";",
    "Ë": ":",
    "ï¼Œ": ",",
    "â€¦": "...",
    "`Ê»â€˜â€™â€²á¾½â€›Ê¾Ê¹Â´Ê¹Ê¼Ğ¬ÑŒ": "'",
    "â€œâ€â€âââ€³ĞªÑŠ": "\"",
    "ã€Š": "Â«",
    "ã€‹": "Â»",
    "ËšÂ°Âº": "Â°",
    "â”‚": "|",
    "Ã·": "/",
    "Â½": "1/2",
    "â…“": "1/3",
    "Â¼": "1/4",
    "Â¾": "3/4",
    "â…¡": "II",
    "â…¢": "III",
    "â…£": "IV",
    "â…§": "VIII",
    "â…¨": "IX",
    "â…«": "XII",
    "ã¡": "m2",
}


def strip_replace(s: str) -> tuple[str, list[str]]:
    s = re.sub("\t", " ", s)
    s = re.sub("\r", " ", s)
    s = re.sub(" +", " ", s)
    for old, new in replace_chars.items():
        s = re.sub("[" + old + "]", new, s)
    invalid_chars = sorted(set(s).difference(valid_chars))
    for char in invalid_chars:
        s = s.replace(char, "")
    return s, invalid_chars
